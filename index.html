<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8" />
  <title>ä¸ºäº†å®è— - ç»Ÿä¸€æ¶æ„ç‰ˆ</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #1a1a2e; overflow: hidden; font-family: sans-serif; color: white; }
    #game-canvas { display: block; cursor: grab; }
    .fullscreen { position: fixed; inset: 0; display: none; justify-content: center; align-items: center; flex-direction: column; background: rgba(10, 10, 30, 0.95); z-index: 50; }
    #hero-slots { display: flex; gap: 20px; margin-bottom: 24px; }
    .hero-card { width: 120px; background: #2c2c54; padding: 15px; border-radius: 8px; cursor: pointer; text-align: center; border: 2px solid transparent; }
    .hero-card.selected { border-color: #f39c12; background: #3d3468; }
    #char-confirm-btn { background: #e67e22; border: none; padding: 10px 30px; color: white; border-radius: 5px; cursor: pointer; }
    #char-confirm-btn:disabled { opacity: 0.4; }

    /* â”€â”€ RPG é£æ ¼å·¦ä¸Šè§’çŠ¶æ€æ  â”€â”€ */
    #party-status-overlay {
      position: fixed;
      top: 60px;
      left: 20px;
      z-index: 30;
      display: none;
      flex-direction: column;
      gap: 12px;
      /* ä¿®æ”¹ï¼šå…è®¸ç‚¹å‡»äº¤äº’ */
      pointer-events: auto; 
    }
    .hero-status-box {
      background: linear-gradient(135deg, rgba(44, 44, 84, 0.9), rgba(20, 20, 40, 0.95));
      border-left: 4px solid #f39c12;
      padding: 10px 15px;
      min-width: 240px;
      box-shadow: 4px 4px 10px rgba(0,0,0,0.5);
      border-radius: 0 8px 8px 0;
      transition: all 0.3s ease;
      /* ä¿®æ”¹ï¼šå¢åŠ ç‚¹å‡»æ‰‹å‹ */
      cursor: pointer; 
    }
    .hero-status-box:hover {
      background: linear-gradient(135deg, rgba(54, 54, 94, 0.95), rgba(30, 30, 50, 0.95));
      transform: translateX(5px);
    }
    .hp-bar-bg { width: 100%; height: 8px; background: #1a1a2e; border-radius: 4px; margin-top: 5px; overflow: hidden; border: 1px solid #444; }
    .hp-bar-fill { height: 100%; background: linear-gradient(90deg, #2ecc71, #27ae60); transition: width 0.4s ease; }
    .hp-text { font-size: 11px; text-align: right; color: #aaa; margin-top: 2px; font-family: monospace; }
    
    /* è¯¦æƒ…å±•ç¤ºåŒºåŸŸ */
    .stat-detail { 
      font-size: 11px; 
      color: #f39c12; 
      margin-top: 8px; 
      display: none; 
      border-top: 1px solid rgba(255,255,255,0.1); 
      padding-top: 8px; 
      pointer-events: none; /* è¯¦æƒ…æ–‡å­—ä¸é˜»æŒ¡ç‚¹å‡» */
    }

    /* â”€â”€ é¡¶éƒ¨è¿›åº¦æ¡ â”€â”€ */
    #top-progress { position: fixed; top: 0; left: 0; right: 0; display: none; flex-direction: column; align-items: center; padding: 10px 40px 14px; background: rgba(0, 0, 0, 0.55); backdrop-filter: blur(4px); z-index: 20; gap: 6px; }
    #top-progress-header { display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 700px; }
    #turn-progress-track { position: relative; width: 100%; max-width: 700px; height: 18px; background: #2a2a3a; border-radius: 9px; overflow: hidden; border: 1px solid rgba(255, 255, 255, 0.1); }
    #turn-progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, #e67e22, #e74c3c); border-radius: 9px; transition: width 0.4s ease; }
    #hud { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: none; background: rgba(0, 0, 0, 0.6); padding: 10px 20px; border-radius: 10px; z-index: 10; gap: 15px; align-items: center; }

    /* ====== åŠ¨ç”»ä¸ç‰¹æ•ˆ CSS ====== */
    .animate-spin-slow { animation: spin 0.5s linear infinite; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .custom-scrollbar::-webkit-scrollbar { width: 4px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #292524; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #57534e; border-radius: 4px; }
    .animate-bounce-short { animation: bounce-short 1s ease-in-out forwards; }
    @keyframes bounce-short { 0%, 100% { transform: translateY(0); opacity: 0; } 20% { transform: translateY(-20px) scale(1.2); opacity: 1; } 80% { opacity: 1; } }
    .shake-effect { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes shake { 10%, 90% { transform: translate3d(-3px, 0, 0) rotate(-1deg); } 20%, 80% { transform: translate3d(4px, 0, 0) rotate(1deg); } 30%, 50%, 70% { transform: translate3d(-6px, 0, 0) rotate(-2deg); } 40%, 60% { transform: translate3d(6px, 0, 0) rotate(2deg); } }
    .slash-effect { position: absolute; inset: 0; z-index: 40; border-radius: 0.5rem; pointer-events: none; background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.9) 48%, rgba(220,38,38,0.7) 50%, transparent 55%); background-size: 200% 200%; animation: slash 0.3s cubic-bezier(0.1, 0.8, 0.3, 1) forwards; }
    @keyframes slash { 0% { background-position: 200% 0; opacity: 0; } 50% { opacity: 1; } 100% { background-position: -50% 100%; opacity: 0; } }
    .heal-effect { position: absolute; inset: 0; z-index: 40; border-radius: 0.5rem; pointer-events: none; background: radial-gradient(circle, rgba(74,222,128,0.5) 0%, transparent 70%); animation: pulse-heal 0.6s ease-out forwards; }
    @keyframes pulse-heal { 0% { transform: scale(0.5); opacity: 0; } 50% { opacity: 1; } 100% { transform: scale(1.2); opacity: 0; } }
  </style>
</head>

<body>
<canvas id="game-canvas"></canvas>

<div id="party-status-overlay"></div>

<div id="top-progress">
  <div id="top-progress-header">
    <span style="color:#f39c12; font-weight:bold;">ğŸ’€ æœ€ç»ˆ Boss å€’è®¡æ—¶</span>
    <span style="color:#aaa;">å›åˆ <span id="turn-progress-text">0/20</span></span>
  </div>
  <div id="turn-progress-track"><div id="turn-progress-bar"></div></div>
</div>

<div id="char-select-screen" class="fullscreen">
  <h2 style="margin-bottom:20px; color:#f39c12;">é€‰æ‹©ä½ çš„è‹±é›„</h2>
  <div id="hero-slots"></div>
  <div id="char-selected-info" style="margin-bottom:20px; color:#aaa;">è¯·é€‰æ‹© 2 åè‹±é›„</div>
  <button id="char-confirm-btn" disabled>å¼€å§‹å†’é™©</button>
</div>

<div id="map-gen-screen" class="fullscreen"><h2>æ­£åœ¨æ„å»ºä¸–ç•Œ...</h2></div>

<div id="hud">
  <span id="movement-points">è¡ŒåŠ¨åŠ›ï¼š-</span>
  <button id="end-turn-btn" style="background:#e67e22; border:none; color:white; padding:6px 16px; border-radius:4px; cursor:pointer;">ç»“æŸå›åˆ</button>
</div>

<div id="react-combat-root" style="display: none; position: fixed; inset: 0; z-index: 100;"></div>

<div id="event-ui" style="position: fixed; inset: 0; display: none; justify-content: center; align-items: center; background: rgba(0,0,0,0.6); z-index: 200;">
  <div style="background: #2c2c54; padding: 30px; border-radius: 12px; text-align: center; min-width: 300px;">
    <h3 id="event-title"></h3><p id="event-desc"></p>
    <div id="event-buttons" style="margin-top:20px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center;"></div>
  </div>
</div>

<script type="module" src="./main.js"></script>
<script type="text/babel" src="src/ui/CombatUI.js"></script>
</body>
</html>